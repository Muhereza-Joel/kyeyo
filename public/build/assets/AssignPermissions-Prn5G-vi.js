import{r as h,m as R,j as e,L as S}from"./app-4B1NWssN.js";import{A as w,u as C}from"./AuthenticatedLayout-C-zcp4iv.js";import{P as E}from"./PrimaryButton-BJ-AR_8w.js";import{A as L,a as B}from"./AlertSuccess-3GPIzB0W.js";import"./ApplicationLogo-DU19jAuR.js";import"./transition-D-G6KCPn.js";import"./index-0GQTMshf.js";function I({auth:p,roles:r,permissions:n,userPermissions:o,success:c,error:m,avator:y}){const[t,g]=h.useState(null),{data:l,setData:a,post:f,processing:x}=R({assignedPermissions:[]}),{can:u}=C(o);h.useEffect(()=>{if(r.length>0){const s=r[0];g(s),a("assignedPermissions",s.permissions.map(i=>i.uuid))}},[r]);const j=s=>{g(s),a("assignedPermissions",s.permissions.map(i=>i.uuid))},b=s=>Array.isArray(l.assignedPermissions)?l.assignedPermissions.includes(s):!1,P=s=>{a(i=>{const d=Array.isArray(i.assignedPermissions)?i.assignedPermissions:[],A=d.includes(s);return{...i,assignedPermissions:A?d.filter(v=>v!==s):[...d,s]}})},k=s=>{s?a("assignedPermissions",n.map(i=>i.uuid)):a("assignedPermissions",[])},N=s=>{s.preventDefault(),t&&f(route("roles.save-assigned-permissions",t),{onSuccess:()=>{},onError:()=>{}})};return e.jsxs(w,{user:p.user,permissions:o,avator:y,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-100 dark:text-gray-200 leading-tight",children:"Assign Permissions to Roles"}),children:[e.jsx(S,{title:"Assign Permissions to Roles"}),e.jsxs("div",{className:"py-2 max-w-7xl mx-auto sm:px-6 lg:px-8",children:[c&&e.jsx(L,{success:c}),m&&e.jsx(B,{error:m}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 p-2",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:"Roles"}),e.jsx("ul",{className:"mt-4 space-y-2",children:r.map(s=>(s.name==="root"||s.name==="admin")&&!u("Create Role")?null:e.jsx("li",{className:`p-2 rounded-md cursor-pointer ${(t==null?void 0:t.uuid)===s.uuid?"bg-blue-500 text-white":"hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200"}`,onClick:()=>j(s),children:s.name},s.uuid))})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg p-4",children:t?e.jsxs("form",{onSubmit:N,children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200",children:["Permissions for ",t.name," role"]}),e.jsxs("div",{className:"flex items-center mt-4 justify-end",children:[e.jsx("label",{htmlFor:"select-all",className:"me-3 text-gray-800 dark:text-gray-200",children:"Select All"}),e.jsx("input",{type:"checkbox",id:"select-all",onChange:s=>k(s.target.checked),checked:l.assignedPermissions.length===n.length,className:"form-checkbox text-blue-500 me-2"})]}),e.jsx("ul",{className:"mt-4 space-y-2",children:n.map(s=>e.jsxs("li",{className:"flex items-center justify-between p-2 border-b dark:border-gray-600",children:[e.jsx("span",{className:"text-gray-800 dark:text-gray-200",children:s.name}),e.jsx("input",{type:"checkbox",checked:b(s.uuid),onChange:()=>P(s.uuid),className:"form-checkbox text-blue-500"})]},s.uuid))}),e.jsx("div",{className:"mt-4 flex justify-end",children:u("Assign Permission")&&e.jsx(E,{type:"submit",disabled:x,children:x?"Saving...":"Save Changes"})})]}):e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Select a role to manage permissions."})})]})]})]})}export{I as default};
